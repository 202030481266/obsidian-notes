
# 欧几里得算法

### 欧几里得算法

欧几里得算法，也称为辗转相除法，是一种用于计算两个非负整数最大公约数（GCD, Greatest Common Divisor）的高效算法。这个算法得名于古希腊数学家欧几里得，最早在他编著的《几何原本》中提出。

### 基本思想

欧几里得算法的核心思想是：**两个整数的最大公约数等于较小数和两数相除所得余数的最大公约数**。公式可以表示为：

$$
\text{gcd}(a, b) = \text{gcd}(b, a \% b)
$$

其中，$a \% b$ 表示 $a$ 除以 $b$ 的余数。这个过程会一直递归，直到其中一个数为 0，此时另一个数即为两者的最大公约数。

### 步骤说明

1. 给定两个整数 $a$ 和 $b$（假设 $a > b$），计算 $a$ 除以 $b$ 的余数 $r = a \% b$。
2. 将问题转化为计算 $b$ 和 $r$ 的最大公约数。
3. 重复上述过程，直到余数为 0，此时较大的数就是两者的最大公约数。

### 例子

假设我们要计算 252 和 105 的最大公约数：

1. $252 \div 105 = 2$，余数为 $42$，因此我们将问题转化为 $\text{gcd}(105, 42)$。
2. $105 \div 42 = 2$，余数为 $21$，因此我们将问题转化为 $\text{gcd}(42, 21)$。
3. $42 \div 21 = 2$，余数为 $0$，因此 $\text{gcd}(21, 0)$，结果为 $21$。

所以，252 和 105 的最大公约数是 21。

### 时间复杂度

欧几里得算法的时间复杂度是 $O(\log(\min(a, b)))$，这意味着即使对非常大的整数，欧几里得算法也能高效地求解。

### 扩展欧几里得算法

扩展欧几里得算法不仅能求两个数的最大公约数，还能找到一对整数 $x$ 和 $y$，使得：

$$
a \times x + b \times y = \text{gcd}(a, b)
$$

这个方程称为贝祖等式（Bézout's identity）。扩展欧几里得算法在数论和密码学（例如 RSA 算法）中有重要的应用，因为它能求解线性同余方程。

### C++ 实现

以下是欧几里得算法和扩展欧几里得算法的 C++ 实现：

#### 欧几里得算法

```cpp
#include <iostream>
using namespace std;

int gcd(int a, int b) {
    while (b != 0) {
        int temp = a % b;
        a = b;
        b = temp;
    }
    return a;
}

int main() {
    int a = 252, b = 105;
    cout << "GCD of " << a << " and " << b << " is: " << gcd(a, b) << endl;
    return 0;
}
```

#### 扩展欧几里得算法

```cpp
#include <iostream>
using namespace std;

int extended_gcd(int a, int b, int &x, int &y) {
    if (b == 0) {
        x = 1;
        y = 0;
        return a;
    }
    int x1, y1;
    int gcd = extended_gcd(b, a % b, x1, y1);
    x = y1;
    y = x1 - (a / b) * y1;
    return gcd;
}

int main() {
    int a = 252, b = 105, x, y;
    int gcd = extended_gcd(a, b, x, y);
    cout << "GCD of " << a << " and " << b << " is: " << gcd << endl;
    cout << "x = " << x << ", y = " << y << endl;
    return 0;
}
```

在扩展欧几里得算法中，除了计算 $a$ 和 $b$ 的最大公约数，我们还计算了系数 $x$ 和 $y$，使得 $a \times x + b \times y = \text{gcd}(a, b)$。

---
### 欧几里得算法证明

本质上就是证明：$\gcd(a, b) = \gcd(b, a \% b)$

假设 $a \% b = r$，即我们需要证明 $\gcd(a, b) = \gcd(b, r)$。

#### 证明过程：

因为 $a \% b = r$，所以如下两个等式必然成立：

1) $a = b \times q + r$，其中 $q$ 为 $0, 1, 2, 3, \ldots$ 中的一个整数。
2) $r = a − b \times q$，其中 $q$ 为 $0, 1, 2, 3, \ldots$ 中的一个整数。

#### 第一步：

假设 $u$ 是 $a$ 和 $b$ 的公因子，则可以表示为：
$$ a = s \times u,\ b = t \times u $$
把 $a$ 和 $b$ 带入第二个等式 $r = a - b \times q$，得到：
$$ r = s \times u - t \times u \times q = (s - t \times q) \times u $$
这说明：**如果 $u$ 是 $a$ 和 $b$ 的公因子，那么 $u$ 也是 $r$ 的因子**。

#### 第二步：

假设 $v$ 是 $b$ 和 $r$ 的公因子，则有：
$$ b = x \times v,\ r = y \times v $$
把 $b$ 和 $r$ 带入第一个等式 $a = b \times q + r$，得到：
$$ a = x \times v \times q + y \times v = (x \times q + y) \times v $$
这说明：**如果 $v$ 是 $b$ 和 $r$ 的公因子，那么 $v$ 也是 $a$ 的公因子**。

#### 结论：

综上所述，$a$ 和 $b$ 的每一个公因子也是 $b$ 和 $r$ 的一个公因子，反之亦然。因此，$a$ 和 $b$ 的全体公因子集合等于 $b$ 和 $r$ 的全体公因子集合，即：

$$ \gcd(a, b) = \gcd(b, r) $$

这就证明了辗转相除法的正确性。

### 扩展欧几里得算法证明

#### 回顾扩展欧几里得算法的结论

扩展欧几里得算法的目标是找到一对整数 $x$ 和 $y$，使得对于给定的整数 $a$ 和 $b$，满足：

$$
a \times x + b \times y = \gcd(a, b)
$$
我们称这个方程为**贝祖等式**（Bézout's identity），也叫做裴蜀定理。

扩展欧几里得算法基于普通的欧几里得算法，通过递归的方式一步一步缩小问题规模，最终求解到我们关心的 $x$ 和 $y$。

#### 证明过程

首先回顾欧几里得算法中 $\gcd(a, b)$ 的推导过程：
$$
\gcd(a, b) = \gcd(b, a \% b)
$$
通过扩展欧几里得算法，我们在每一步都能得到两个数的贝祖等式解，也就是：

$$
b \times x' + (a \% b) \times y' = \gcd(b, a \% b)
$$

根据普通欧几里得算法，我们知道 $\gcd(b, a \% b) = \gcd(a, b)$。所以，只需要证明如何从这一步推导出 $a \times x + b \times y = \gcd(a, b)$。

#### 第一步：展开模运算

因为 $a \% b$ 可以通过以下方式表示：
$$
a \% b = a - (a // b) \times b
$$

将其代入到贝祖等式 $b \times x' + (a \% b) \times y' = \gcd(a, b)$ 中：

$$
b \times x' + (a - (a // b) \times b) \times y' = \gcd(a, b)
$$

展开等式：

$$
b \times x' + a \times y' - (a // b) \times b \times y' = \gcd(a, b)
$$

整理后得到：

$$
a \times y' + b \times (x' - (a // b) \times y') = \gcd(a, b)
$$

#### 第二步：定义新的 $x$ 和 $y$

观察到式子中的 $a$ 和 $b$ 的系数分别是 $y'$ 和 $x' - (a // b) \times y'$。因此，我们可以重新定义新的 $x$ 和 $y$：

$$
x = y'
$$

$$
y = x' - (a // b) \times y'
$$

此时，我们就得到了：
$$
a \times x + b \times y = \gcd(a, b)
$$

这就是我们需要的贝祖等式。扩展欧几里得算法通过不断递归，最终从底层的简单情况（$\gcd(a, 0) = a$）一步步回溯，得到了所有的 $x$ 和 $y$。

### 结论

通过递归，扩展欧几里得算法一步步将问题简化，最终我们能够找到一对整数 $x$ 和 $y$，使得：
$$
a \times x + b \times y = \gcd(a, b)
$$
这个过程依赖于递归的回溯，逐步构造出了满足条件的 $x$ 和 $y$，从而证明了扩展欧几里得算法的正确性。

---

### 裴蜀定理（Bézout's identity）

**定理内容**：

对于两个非零整数 $a$ 和 $b$，它们的最大公约数 $\gcd(a, b)$ 可以被表示为 $a$ 和 $b$ 的整数线性组合，即**存在一对整数 $x$ 和 $y$**，使得：

$$
a \times x + b \times y = \gcd(a, b)
$$

这种形式的等式就被称为**裴蜀等式**。定理表明，$a$ 和 $b$ 的最大公约数是它们的某种整数倍加和。

#### 裴蜀定理的简单例子

假设我们有两个数 $a = 56$ 和 $b = 15$，我们想找到 $x$ 和 $y$，使得：

$$
56 \times x + 15 \times y = \gcd(56, 15)
$$

通过欧几里得算法，我们可以知道 $\gcd(56, 15) = 1$。然后通过扩展欧几里得算法，我们可以求得 $x = -4$ 和 $y = 15$，因此有：

$$
56 \times (-4) + 15 \times 15 = 1
$$

这个过程就是裴蜀定理的最常见应用。

#### 裴蜀定理的证明思路

**裴蜀定理的证明过程实际上就是扩展欧几里得算法的推导过程**。通过反复使用欧几里得算法的递归过程，我们可以逐步找到一对 $x$ 和 $y$，使得：

$$
a \times x + b \times y = \gcd(a, b)
$$

这也是为什么扩展欧几里得算法可以用来求解裴蜀等式的原因。

#### 多项裴蜀定理

裴蜀定理不仅适用于两个整数，还可以推广到多个整数。其推广形式为：

对于任意的 $n$ 个整数 $a_1, a_2, \dots, a_n$，它们的最大公约数 $\gcd(a_1, a_2, \dots, a_n)$ 可以表示为 $a_1, a_2, \dots, a_n$ 的线性组合。也就是说，存在一组整数 $x_1, x_2, \dots, x_n$ 使得：

$$
a_1 \times x_1 + a_2 \times x_2 + \dots + a_n \times x_n = \gcd(a_1, a_2, \dots, a_n)
$$

这就是多项裴蜀定理的形式。下面是一个例子，可以直观感受到多项裴蜀定理的过程：

假设我们有三个整数 $a_1 = 56$，$a_2 = 98$，$a_3 = 42$，我们要找到整数 $x_1, x_2, x_3$ 使得：

$$
56 \times x_1 + 98 \times x_2 + 42 \times x_3 = \gcd(56, 98, 42)
$$

首先，我们通过欧几里得算法计算 $\gcd(56, 98, 42)$。可以通过如下步骤：

1. 计算 $\gcd(56, 98) = 14$
2. 再计算 $\gcd(14, 42) = 14$

所以，$\gcd(56, 98, 42) = 14$。接下来，我们需要找到满足以下等式的整数 $x_1, x_2, x_3$：

$$
56 \times x_1 + 98 \times x_2 + 42 \times x_3 = 14
$$

这时，我们可以通过扩展欧几里得算法逐步求出 $x_1, x_2, x_3$ 的值。那么如何求解呢？

实际上，多项裴蜀定理可以通过**递归**的方式来求解。我们先用扩展欧几里得算法对前两个数 $a_1$ 和 $a_2$ 求出：

$$
a_1 \times x_1 + a_2 \times x_2 = \gcd(a_1, a_2)
$$

然后，继续将这个 $\gcd(a_1, a_2)$ 和 $a_3$ 一起代入，求得：

$$
\gcd(a_1, a_2) \times y_1 + a_3 \times y_3 = \gcd(a_1, a_2, a_3)
$$

通过这个过程，最终我们可以得到一组解 $x_1, x_2, \dots, x_n$，使得多项裴蜀等式成立。

为了更好理解裴蜀定理在多个数中的推广，可以将其分为以下步骤：

1. **第一步：两项计算**。首先使用扩展欧几里得算法计算 $\gcd(a_1, a_2)$ 并找到相应的 $x_1, x_2$ 使得 $a_1 \times x_1 + a_2 \times x_2 = \gcd(a_1, a_2)$。

2. **第二步：递归处理**。将 $\gcd(a_1, a_2)$ 和下一个数 $a_3$ 进行扩展欧几里得算法的递归计算。找到 $y_1, y_3$ 使得 $\gcd(a_1, a_2) \times y_1 + a_3 \times y_3 = \gcd(a_1, a_2, a_3)$。

3. **重复步骤**。继续递归计算下去，直到处理完所有的 $a_n$。

---
### 裴蜀定理应用

裴蜀定理（Bézout's identity）在算法竞赛中有几个非常重要的推论，这些推论对解决许多数论和代数问题至关重要。以下是裴蜀定理的一些重要推论以及它们在算法竞赛中的应用：

#### 1. **线性不定方程的可解性**

**推论**：对于线性不定方程 $a \times x + b \times y = c$，它有整数解的充要条件是 $c$ 是 $\gcd(a, b)$ 的倍数。

在算法竞赛中，经常会遇到求解线性不定方程的问题。根据这个推论，如果 $\gcd(a, b)$ 不能整除 $c$，则方程无解。如果 $\gcd(a, b)$ 能整除 $c$，通过扩展欧几里得算法，我们可以快速求出 $x$ 和 $y$。

比如，方程 $56 \times x + 15 \times y = 1$，由于 $\gcd(56, 15) = 1$，它有整数解。通过扩展欧几里得算法，我们可以求出 $x = -4$ 和 $y = 15$。

#### 2. **模线性方程的求解**

**推论**：线性同余方程 $a \times x \equiv b \ (\text{mod} \ m)$ 在 $\gcd(a, m)$ 整除 $b$ 的情况下有解。

在线性同余方程中，如果我们想求出 $x$，使得 $a \times x \equiv b \ (\text{mod} \ m)$，这个推论给出了问题是否有解的条件。通过裴蜀定理，线性同余方程的解可以通过扩展欧几里得算法求得。

比如，如果方程 $2 \times x \equiv 3 \ (\text{mod} \ 5)$，我们可以使用扩展欧几里得算法来求解这个方程。因为 $\gcd(2, 5) = 1$，所以解存在。

#### 3. **求模逆元**

**推论**：如果 $a$ 和 $m$ 互质（即 $\gcd(a, m) = 1$），则存在唯一的模逆元 $x$，满足 $a \times x \equiv 1 \ (\text{mod} \ m)$，并且可以通过扩展欧几里得算法找到这个逆元。

在许多算法竞赛问题中，求逆元是常见的需求，特别是在涉及模运算的情况下。根据这个推论，如果 $a$ 和 $m$ 互质，则一定存在模逆元，可以用来求解许多数论问题，尤其是在加密算法和组合数学中。

假设我们需要计算 $7 \times x \equiv 1 \ (\text{mod} \ 13)$。因为 $\gcd(7, 13) = 1$，所以解存在。通过扩展欧几里得算法，我们可以找到 $x = 2$，即 $7$ 在模 $13$ 下的逆元是 $2$，因为 $7 \times 2 \equiv 1 \ (\text{mod} \ 13)$。

#### 4. **求解中国剩余定理**

**推论**：当我们有一组线性同余方程系统：
$$
\begin{align}
x \equiv a_1 \ (\text{mod} \ m_1) \\
x \equiv a_2 \ (\text{mod} \ m_2) \\
\vdots \\
x \equiv a_n \ (\text{mod} \ m_n)
\end{align}
$$

如果模数 $m_1, m_2, \dots, m_n$ 两两互质，则这个系统有解，且可以通过裴蜀定理和扩展欧几里得算法求出具体的解。

中国剩余定理在很多组合问题和同余方程组问题中非常常见。例如，如果我们需要找到一个数，它在模不同数时满足特定条件，可以用这个方法快速求解。

设有以下同余方程组：
$$
\begin{align}
x \equiv 2 \ (\text{mod} \ 3) \\
x \equiv 3 \ (\text{mod} \ 5) \\
x \equiv 2 \ (\text{mod} \ 7)
\end{align}
$$
因为 $3, 5, 7$ 互质，问题有解，并且可以通过扩展欧几里得算法和中国剩余定理求解得到 $x = 23$。

####  5. **裴蜀定理在迪奥凡丁方程中的应用**

**推论**：对于形如 $a_1 \times x_1 + a_2 \times x_2 + \dots + a_n \times x_n = b$ 的**迪奥凡丁方程**，如果 $\gcd(a_1, a_2, \dots, a_n)$ 能整除 $b$，则该方程有整数解。

在许多算法竞赛问题中，迪奥凡丁方程的求解非常重要，特别是在资源分配、背包问题、以及其他数论相关问题中。使用裴蜀定理可以帮助我们判断方程是否有解，并通过扩展欧几里得算法求出具体解。

比如，对于方程 $6 \times x + 15 \times y = 12$，$\gcd(6, 15) = 3$，因为 $3$ 整除 $12$，所以方程有解。通过扩展欧几里得算法，我们可以找到具体解。

