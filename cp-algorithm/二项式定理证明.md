
## 二项式定理

$$(a + b)^n = \sum_{k=0}^{n} \binom{n}{k} a^{n-k} b^k$$

当 $a = 1, b = 1$ 时，就是著名的杨辉三角，也叫帕斯卡三角。

$$(1 + 1)^n = \sum_{k=0}^{n} \binom{n}{k}$$

$$
\begin{array}{ccccccc}
& & & 1 & & & \\
& & 1 & & 1 & & \\
& 1 & & 2 & & 1 & \\
1 & & 3 & & 3 & & 1 \\
1 & 4 & & 6 & & 4 & 1 \\
1 & 5 & 10 & & 10 & 5 & 1 \\
\end{array}
$$

可以得到一个结论，也就是著名的组合恒等式：

$$C(i, j) = C(i-1, j) + C(i-1, j-1)$$

$$
\binom{i}{j} = \binom{i-1}{j} + \binom{i-1}{j-1}
$$

这可以用于打表，大规模生成组合的方法数，生成 $n \times n$ 的表时间复杂度 $O(n^2)$，单次查询 $O(1)$。当然也可以用阶乘余数表、阶乘逆元表来求解 $C(n, k)$，生成的时间复杂度 $O(n)$，单次查询 $O(1)$。

## 证明：二项式定理

二项式定理的形式

我们要证明的二项式定理为：

$$(a + b)^n = \sum_{k=0}^{n} \binom{n}{k} a^{n-k} b^k$$

其中，$$\binom{n}{k} = \frac{n!}{k!(n-k)!}$$ 是二项式系数。

### 证明方法：数学归纳法

**第一步：验证基例 $n = 1$**

当 $n = 1$ 时，有：

$$(a + b)^1 = a + b$$

根据二项式定理的右侧展开：

$$\sum_{k=0}^{1} \binom{1}{k} a^{1-k} b^k = \binom{1}{0} a^1 b^0 + \binom{1}{1} a^0 b^1 = a + b$$

因此，基例 $n = 1$ 的情况成立。

---

**第二步：归纳假设**

假设对于 $n = m$ 时，二项式定理成立，即：

$$(a + b)^m = \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^k$$

我们接下来要证明 $n = m + 1$ 时，二项式定理也成立。

---

**第三步：归纳步骤**

我们需要证明对于 $n = m + 1$ 时，$(a + b)^{m+1}$ 的展开形式依然符合二项式定理，即：

$$(a + b)^{m+1} = \sum_{k=0}^{m+1} \binom{m+1}{k} a^{m+1-k} b^k$$

根据归纳假设：

$$(a + b)^{m+1} = (a + b)(a + b)^m = (a + b) \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^k$$

将 $(a + b)$ 乘到每一项中，展开为：

$$= a \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^k + b \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^k$$

分别对两部分分别进行处理。

---

**第四步：对两部分求和**

第一个和式是：

$$
a \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^k = \sum_{k=0}^{m} \binom{m}{k} a^{m+1-k} b^k
$$

第二个和式是：

$$
b \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^k = \sum_{k=0}^{m} \binom{m}{k} a^{m-k} b^{k+1}
$$

此时，我们对第二部分的下标 $k$ 进行调整，换元 $k' = k + 1$：

$$
\sum_{k=1}^{m+1} \binom{m}{k-1} a^{m+1-k} b^k
$$

---

**第五步：合并两个求和式并应用组合数性质**

现在我们可以将两部分相加，得到：

$$
\sum_{k=0}^{m} \binom{m}{k} a^{m+1-k} b^k + \sum_{k=1}^{m+1} \binom{m}{k-1} a^{m+1-k} b^k
$$

合并两项后，结果可以表示为：

$$
\binom{m}{0} a^{m+1} b^0 + \sum_{k=1}^{m} \left( \binom{m}{k} + \binom{m}{k-1} \right) a^{m+1-k} b^k + \binom{m}{m} a^0 b^{m+1}
$$

**应用组合数性质**：根据组合数的性质，$\binom{m}{k} + \binom{m}{k-1} = \binom{m+1}{k}$，所以我们可以将上式进一步化简为：

$$
\binom{m}{0} a^{m+1} b^0 + \sum_{k=1}^{m} \binom{m+1}{k} a^{m+1-k} b^k + \binom{m}{m} a^0 b^{m+1}
$$

因此，化简之后，整个表达式变为：

$$
\sum_{k=0}^{m+1} \binom{m+1}{k} a^{m+1-k} b^k
$$
